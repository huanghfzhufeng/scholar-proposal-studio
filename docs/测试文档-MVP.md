# 校研智申 MVP 测试文档（已确认版）

## 1. 文档信息
- 项目名称：校研智申
- 版本：v1.0（确认版）
- 日期：2026-02-14
- 状态：已确认，可执行测试
- 关联需求：`/Users/zeke/agent dome/NatGrant/docs/需求文档-MVP.md`

## 2. 测试目标
- 验证 11 项 MVP 必做功能全部可用。
- 验证核心端到端流程无阻断，可用于校内 100 人以内试点。
- 验证 Word/PDF 双导出均稳定可用。
- 验证“软删除归档（入水库）+ 恢复”机制可用。

## 3. 测试策略与重点
- 重点类型：功能测试、回归测试、可用性测试。
- 非重点类型：性能压测、安全渗透（MVP 暂不纳入硬门槛）。
- 执行节奏：
1. 每次构建先跑冒烟。
2. 每个迭代结束跑功能全量 + 回归。
3. 上线前做一次完整 UAT。

## 4. 测试范围
### 4.1 必测功能范围（对应 11 项）
1. 纯对话式动态访谈。
2. 候选大纲生成（2-5 套）。
3. 大纲细粒度编辑。
4. 大纲确认后回退修改。
5. 大纲版本历史与差异对比。
6. 联网检索与资料库管理。
7. 一键整篇生成（过程可视化）。
8. 全文编辑与自动保存。
9. Word 导出。
10. PDF 导出。
11. 项目软删除归档与恢复。

### 4.2 工程结构验收（新增强制项）
1. 每个业务智能体具备独立目录。
2. 每个智能体目录均包含 `agent.ts`、`prompt.ts`、`tools.ts`。
3. 提示词仅出现在 `prompt.ts`，不散落在页面层或编排层。
4. 智能体之间仅通过编排层交互，不出现跨智能体直接调用内部实现。
5. 工具能力由 `tools.ts` 统一暴露，不在 UI 层直接拼接工具调用。
### 4.3 不纳入本期门槛
1. SSO 登录联调测试。
2. 管理员后台测试。
3. 附件上传解析测试。
4. AI 改写能力测试。
5. 大规模并发压测。

## 5. 测试环境
- 前端：Next.js + Tailwind。
- 运行环境：Node.js LTS（建议 20.x）。
- 浏览器：主流现代浏览器。
- 终端覆盖：
1. 桌面端全流程。
2. 移动端全流程（含编辑与导出触发）。
- 测试数据：
1. 学术方向样例课题 >= 3 组。
2. 每组含访谈输入、预期大纲结构、检索样例来源。

## 6. 通过标准（质量门槛）
- 上线门槛：
1. P0 缺陷 = 0。
2. P1 缺陷 = 0。
3. 核心用例通过率 = 100%。
4. 工程结构验收项全部通过。
- 发布条件：满足以上门槛后，由项目负责人确认上线。

## 7. 缺陷分级
- P0：主流程阻断、数据错误或无法导出。
- P1：核心功能异常但有临时绕行方式。
- P2：非核心功能问题或明显体验缺陷。
- P3：优化项与视觉/文案微调。

## 8. 核心测试用例
## 8.1 访谈模块
1. 用例 A-01：动态轮次收集  
步骤：持续回答直到系统判定信息充分  
期望：轮次可动态变化，访谈可正常结束

2. 用例 A-02：用户无法回答时跳过  
步骤：对某问题选择跳过继续  
期望：流程不阻断，系统继续追问其他信息

3. 用例 A-03：刷新恢复  
步骤：访谈中刷新页面  
期望：历史消息与进度可恢复

## 8.2 大纲模块
1. 用例 B-01：候选数量边界  
期望：每次返回 2-5 套候选大纲

2. 用例 B-02：结构合规  
期望：每套均含“立项依据/研究内容/研究基础”主结构

3. 用例 B-03：细粒度编辑  
步骤：增删改最小层级标题并调整顺序  
期望：保存正确，刷新后保留

4. 用例 B-04：确认后回退  
步骤：确认大纲后执行回退修改  
期望：可重新编辑并形成新版本

5. 用例 B-05：版本对比  
步骤：选择两个版本对比  
期望：可展示新增/删除/修改差异

## 8.3 检索与资料库模块
1. 用例 C-01：全网检索 + 学术优先  
期望：结果可返回，学术来源排序优先

2. 用例 C-02：低质量来源过滤  
期望：内容农场/营销软文/灌水站结果被过滤或降权

3. 用例 C-03：资料入库管理  
步骤：纳入/排除/按章节筛选  
期望：资料状态与数量实时更新

## 8.4 全文生成模块
1. 用例 D-01：整篇一键生成  
期望：一次性生成完整正文

2. 用例 D-02：过程可视化  
期望：生成状态可见（开始、处理中、完成）

3. 用例 D-03：文献约束  
步骤：尝试引用资料库外来源  
期望：标记“未核验”，默认不进入正文

4. 用例 D-04：章节最小引用数量  
步骤：触发生成后检查一级章节引用  
期望：每个一级章节 >= 2 条资料库来源

5. 用例 D-05：校验失败自动重试  
步骤：模拟引用不足触发质检失败  
期望：系统自动执行“重检索 -> 重生成”，最多重试 2 次

## 8.5 编辑与导出模块
1. 用例 E-01：全文编辑自动保存  
期望：离开页面后再进入，内容不丢失

2. 用例 E-02：Word 导出  
期望：`.docx` 可打开，文件名等于课题题目

3. 用例 E-03：PDF 导出  
期望：`.pdf` 可打开，文件名等于课题题目

4. 用例 E-04：导出内容约束  
期望：导出文件不带来源目录/附录

## 8.6 删除归档模块
1. 用例 F-01：项目删除  
步骤：执行删除  
期望：项目从列表隐藏并进入“水库”

2. 用例 F-02：项目恢复  
步骤：从水库恢复  
期望：项目可恢复且内容完整

## 8.7 工程结构验收模块
1. 用例 G-01：智能体目录独立  
步骤：检查 `src/agents` 目录  
期望：访谈/大纲/检索/全文 4 个智能体目录独立存在

2. 用例 G-02：三文件齐备  
步骤：检查每个智能体目录  
期望：均存在 `agent.ts`、`prompt.ts`、`tools.ts`

3. 用例 G-03：提示词隔离  
步骤：扫描代码中文本提示词定义  
期望：提示词集中在各自 `prompt.ts`

4. 用例 G-04：编排边界  
步骤：扫描跨目录引用  
期望：智能体间无直接内部调用，仅通过编排层流转

## 9. 冒烟与回归清单
- 冒烟（每次构建）：
1. 新建项目 -> 访谈 -> 大纲 -> 生成 -> 导出，主链路可跑通。
2. Word/PDF 导出都成功。
- 回归（每次迭代）：
1. 历史 P0/P1 缺陷不复现。
2. 大纲版本对比与软删除恢复能力不退化。
3. 移动端全流程仍可操作。

## 10. 测试交付物
1. 测试用例清单（可执行版）。
2. 缺陷台账（含分级、状态、责任人）。
3. 测试报告（通过率、遗留风险、上线建议）。
