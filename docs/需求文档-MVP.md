# 校研智申 MVP 需求文档（已确认版）

## 1. 文档信息
- 项目名称：校研智申
- 版本：v1.0（确认版）
- 日期：2026-02-14
- 状态：已确认，可进入开发
- 产品定位：面向校内科研人员的 AI 国自然申请书生成系统（MVP）

## 2. 项目目标
- 在校内先上线可用 MVP，完成核心流程闭环验证。
- 核心目标不是设定量化 KPI，而是保证核心功能“全部实现、流程可用、演示可跑通”。
- 通过试点用户真实使用，验证产品方向与后续迭代优先级。

## 3. 目标用户与试点
- 目标用户：本校科研人员（不限学院、不限学科）。
- 首批试点规模：100 人以内。
- 上线日期：暂不设固定日期，以验收通过即上线为准。

## 4. 范围定义
### 4.1 MVP 必做范围（一个都不能少）
1. 纯对话式需求访谈（动态轮次）。
2. 候选大纲生成（2-5 套）与选择。
3. 大纲深度编辑（细粒度到最小标题层级）。
4. 大纲确认后回退修改。
5. 大纲版本历史与差异对比。
6. 联网检索与资料库管理。
7. 一键整篇生成全文（过程可视化）。
8. 全文在线编辑与自动保存。
9. Word 导出。
10. PDF 导出。
11. 项目保存、软删除归档与恢复。

### 4.2 非 MVP 范围
1. 校内统一认证（SSO）。
2. 管理员后台（后续版本再做）。
3. 附件上传（PDF/Word/图片）参与访谈。
4. AI 改写能力（扩写、精简、润色、降重）。
5. 审计日志与编辑行为追踪。

## 5. 角色与权限
- 当前仅一个角色：普通用户。
- 管理角色不在 MVP 范围内。

## 6. 数据策略
- 数据存储：服务端持久化存储（MVP 不限定私有化部署形式）。
- 删除策略：允许用户删除项目，但为软删除归档，不做物理永久删除。
- 归档要求：删除数据进入“水库”可保留与恢复。

## 7. 功能需求
## 7.1 模块 A：需求收集（纯对话访谈）
- 交互方式：纯对话式。
- 访谈轮次：不固定，由模型基于回答内容动态追问，直到信息充分。
- 问题生成：每轮自动生成。
- 必答策略：不设固定字段硬门槛；以“信息收集足够”为结束标准；用户无法回答时可跳过，不阻塞流程。
- 访谈结束判定：信息充分度分值 >= 0.8 或用户手动结束。
- 过程能力：
1. 自动保存访谈进度。
2. 支持查看访谈摘要。
3. 支持用户主动结束与模型建议结束。

## 7.2 模块 B：候选大纲生成与确认
- 生成数量：每次生成 2-5 套候选大纲。
- 结构要求：贴合 2026 年国自然申请书结构，至少覆盖：
1. 立项依据
2. 研究内容
3. 研究基础
- 编辑能力：
1. 标题与子标题增删改。
2. 节点顺序调整。
3. 细粒度编辑到最小层级标题。
- 确认与回退：
1. 可锁定大纲版本。
2. 锁定后可回退并继续修改。
3. 提供版本历史与差异对比。

## 7.3 模块 C：联网检索与资料库
- 检索策略：全网检索 + 学术来源优先评分。
- 来源控制：
1. 优先学术站点结果。
2. 初版禁止内容农场、营销软文站、匿名问答灌水站等低质量来源。
- 资料条目字段（MVP）：
1. 标题
2. 来源链接
3. 摘要
4. 关联章节
5. 相关性评分
- 资料管理：
1. 纳入/排除资料库
2. 按章节筛选
3. 手动补充资料条目

## 7.4 模块 D：一键生成全文
- 生成方式：一次性整篇生成。
- 可视化要求：用户可看到生成进度状态（开始、处理中、完成）。
- 文献约束：
1. 禁止编造文献。
2. 默认仅允许使用资料库中的来源条目组织内容。
3. 库外引用标记为“未核验”，默认不进入正文。
4. 每个一级章节至少引用 2 条资料库来源。
5. 若文献约束校验失败，系统自动触发“重检索 -> 重生成”流程，最多重试 2 次。

## 7.5 模块 E：全文编辑与导出
- 编辑能力：
1. 全文与章节编辑
2. 自动保存
- 导出要求：
1. Word 与 PDF 同等优先级
2. 文件名默认使用课题题目
3. 导出时不附来源目录/附录
4. 无学校固定模板时采用默认版式
- 默认版式（已确认）：
1. 中文标题格式
2. 正文宋体小四
3. 1.5 倍行距

## 8. 终端与兼容性
- 桌面端：完整可用。
- 移动端：要求全流程可操作、可编辑，不是仅浏览。
- 浏览器：不设硬性版本门槛，以主流现代浏览器可用为目标。

## 9. 非功能需求
- 性能：MVP 阶段不设硬性时延指标，以可用稳定为第一优先。
- 可用性：核心流程应可被试点用户独立完成。
- 稳定性：核心路径不得出现阻断性故障。

## 10. 验收标准（UAT）
1. 11 项 MVP 必做功能全部完成并可演示。
2. 可完整走通“访谈 -> 大纲 -> 检索 -> 资料入库 -> 整篇生成 -> 编辑 -> 导出”。
3. 大纲支持 2-5 套候选、编辑、确认、回退、版本对比。
4. Word/PDF 均可成功导出，文件名按课题题目生成。
5. 删除为软删除归档，可在“水库”恢复。

## 11. 上线规则
- 上线触发：通过测试验收后上线。
- 不设置固定日历日期。

## 12. 后续迭代建议（不阻塞 MVP）
1. 接入校内 SSO。
2. 增加管理员页面。
3. 引入附件解析（PDF/Word/图片）。
4. 增加 AI 改写能力与质量评分。

## 13. 工程结构约束（强制）
- 目标：代码结构清晰、模块边界清晰、职责单一。
- 约束规则：
1. 每个业务智能体必须有独立文件夹，禁止多个智能体混写在同一目录。
2. 每个智能体目录必须至少包含三个核心文件：
   - `agent.ts`：智能体定义与执行入口。
   - `prompt.ts`：该智能体专属提示词与模板。
   - `tools.ts`：该智能体可调用工具的注册与封装。
3. 提示词不得散落在业务代码中，必须集中在 `prompt.ts`。
4. 工具逻辑不得直接写在页面层，必须经 `tools.ts` 统一导出。
5. 智能体间通信必须通过编排层，不允许相互直接调用内部实现文件。
6. 目录与命名必须语义化，禁止 `utils2.ts`、`temp.ts` 等不可读命名。
